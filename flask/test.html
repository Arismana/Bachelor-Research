<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <button onclick="sendRequest()">按钮</button>
</body>
<script>
    // let bt = document.getElementsByTagName('button')
    function sendRequest(){
            //发送一个Ajax请求需要以下步骤
            console.log(1)

            //1.第一步：创建AJAX核心对象XMLHttpRequest
            var xhr = new XMLHttpRequest()
            //2.第二步：注册回调函数 回调函数在XMLHttpRequest对象的readyState状态值发生改变的时候被调用。
            xhr.onreadystatechange = function (){
                // 这里的回调函数会被调用多次。
                // 0 -> 1 被调用一次
                // 1 -> 2 被调用一次
                // 2 -> 3 被调用一次
                // 3 -> 4 被调用一次
                // console.log(this.readyState) //1 2 3 4
                if(this.readyState === 4) { // 当XMLHttpRequest对象的readyState的状态是4的时候，表示响应结束了。
                    //this.status是http协议指定的http状态码。常见的有 404 500 200等。可自行百度了解。
                    if (this.status === 404) {
                        alert("对不起，您访问的资源不存在，请检查请求路径")
                    } else if(this.status === 500){
                        alert("对不起，服务器发生了严重的内部错误，请联系管理员") //即servlet文件出现报错
                    } else if(this.status === 200){ //请求已完成，响应成功准备就绪。在此可以使用响应回来的数据进行页面渲染了
                        console.log(this.responseText) // 通过XMLHttpRequest对象的responseText属性来获取响应的信息。
                    }
                }
            }
            //3.第三步：开启通道（open只是浏览器和服务器建立连接，通道打开，并不会发送请求）
            xhr.open("GET","http://127.0.0.1:5000//get_request",true)
            // XMLHttpRequest对象的open方法
            // open(method, url, async, user, psw)
            // method: 请求的方式，可以是GET，也可以是POST，也可以是其它请求方式。
            // url：请求的路径 ("/项目名(即部署的时候取得名字)/servlet名(@WebServlet("名字"))")
            // async: 只能是true或者false，true表示此ajax请求是一个异步请求，false表示此ajax请求是一个同步请求。(大部分请求都是true，要求异步。极少数情况需要同步)
            // user：用户名 pwd: 密码，用户名和密码是进行身份认证的，说明要想访问这个服务器上的资源，可能需要提供一些口令才能访问。需不需要用户名和密码，主要看服务器的态度。
            //4.第四步：发送请求
            xhr.send()
        }
</script>
</html>